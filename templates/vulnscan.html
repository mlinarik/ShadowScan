<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Vulnerability Scanner - ShadowScan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .scanner-form { max-width: 600px; margin: 2rem auto; background: #fff; border-radius: 1rem; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 2rem; }
        .results-section { margin-top: 2rem; }
        .vuln-badge { font-size: 0.9rem; margin-right: 0.5rem; }
        .vuln-high { background: #e74c3c; color: #fff; }
        .vuln-medium { background: #f39c12; color: #fff; }
        .vuln-low { background: #27ae60; color: #fff; }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="text-center mt-5 mb-4"><i class="fas fa-bug me-2"></i>Web Vulnerability Scanner</h2>
        <form class="scanner-form" id="vulnscan-form">
            <div class="mb-3">
                <label for="targetUrl" class="form-label">Target URL</label>
                <input type="url" class="form-control" id="targetUrl" name="targetUrl" placeholder="https://example.com" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Scan Options</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="scan_xss" id="scan_xss" checked>
                    <label class="form-check-label" for="scan_xss">Cross-Site Scripting (XSS)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="scan_sqli" id="scan_sqli" checked>
                    <label class="form-check-label" for="scan_sqli">SQL Injection (SQLi)</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" name="scan_misconfig" id="scan_misconfig" checked>
                    <label class="form-check-label" for="scan_misconfig">Common Misconfigurations</label>
                </div>
            </div>
            <button type="submit" class="btn btn-primary w-100">Start Scan</button>
        </form>
        <div class="results-section" id="results-section" style="display:none;">
            <h4>Scan Results</h4>
            <div id="scan-results"></div>
        </div>
    </div>
    <script>
    document.getElementById('vulnscan-form').addEventListener('submit', async function(e) {
        e.preventDefault();
        const form = e.target;
        const data = {
            targetUrl: form.targetUrl.value,
            scan_xss: form.scan_xss.checked,
            scan_sqli: form.scan_sqli.checked,
            scan_misconfig: form.scan_misconfig.checked
        };
        document.getElementById('results-section').style.display = 'none';
        document.getElementById('scan-results').innerHTML = '<div class="text-center my-4"><div class="spinner-border text-primary" role="status"></div><p>Scanning in progress...</p></div>';
        document.getElementById('results-section').style.display = 'block';
        const resp = await fetch('/vulnscan', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        const result = await resp.json();
        let html = '';
        if (result.vulnerabilities && result.vulnerabilities.length > 0) {
            result.vulnerabilities.forEach(vuln => {
                let badgeClass = 'vuln-low';
                if (vuln.severity === 'High') badgeClass = 'vuln-high';
                else if (vuln.severity === 'Medium') badgeClass = 'vuln-medium';
                html += `<div class="alert alert-warning mb-3"><span class="badge ${badgeClass} vuln-badge">${vuln.severity}</span> <strong>${vuln.type}</strong>: ${vuln.description}</div>`;
            });
        } else {
            html = '<div class="alert alert-success">No major vulnerabilities detected.</div>';
        }
        document.getElementById('scan-results').innerHTML = html;
    });
    </script>
</body>
</html>
